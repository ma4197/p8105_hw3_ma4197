---
title: "p8105_hw3_ma4197"
author: "Mayuri Albal"
date: "2022-10-15"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggplot2)
library(readxl)
```

##Problem 1
```{r}
library(p8105.datasets)
data("instacart")
```


##Problem 2

```{r}
accel_data = read_csv(file= "./data/accel_data.csv") %>%
janitor::clean_names() %>%
  mutate(
    wkd_wkn= ifelse(day %in% c('Sunday', 'Saturday'), 'weekend', 'weekday')) %>% 
  relocate(week,day_id, day,wkd_wkn) %>%
  pivot_longer(
    activity_1:activity_1440,
    names_to = "active_num",
    names_prefix = "activity_",
    names_transform=list(activity_=as.numeric),
    values_to = "active_counts") %>% 
    mutate( as.numeric("activity_"))
view(accel_data)
skimr::skim(accel_data)
```
In this cleaned dataset of 'accel_data' there are 6 variables: "week", "day_id", "day",
"wkd_wkn", "active_num", "active_count". "Active_num" and "active_count" were generated
from the previously displayed data for each activity that would occur (1-1440) and the 
corresponding count value the accelerometer measured. There are 50,400 observations within
this new data set.


###Aggregated Data
```{r}
accel_data %>% 
  group_by(day_id) %>% 
  mutate(
    tot_active= sum(active_counts)) %>% 
  summarize(day_id, tot_active) %>% 
  distinct %>% 
  print (n=)
```

####Explanation
Based on the printed table above, there are 35 days included in the data set. When observing
the total activity counts ("tot_active") across the 35 days, there does not appear to be
an definable trend in the total activity of the individual. However, there are dips in total
activity count on days 24 and 31.

###Graphing

```{r}
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
```

Without Lines
```{r}
ggplot(accel_data, aes(x= active_num, y= active_counts)) +
  geom_point(aes(color= day), alpha=0.5) +
  theme_classic()+ 
  theme(legend.position= "bottom")+
  ggtitle("24-Hour Activity Time Count")+
  theme(plot.title = element_text(hjust= 0.5))
    labs(x = "Active Minutes",
        y= "Active Counts") +
   scale_colour_brewer(type = "seq", palette = "Spectral")
```
With Lines

```{r}
ggplot(accel_data, aes(x= active_num, y= active_counts)) +
  geom_point(aes(color= day), alpha=0.5) +
  geom_line(aes(group= day))+
  theme_classic()+ 
  theme(legend.position= "bottom")
   scale_colour_brewer(type = "seq", palette = "Spectral")
```


####Explanation
Based upon this graph, there appears to peaks in active counts being measured from the
accelerometer on Saturday and Sunday for this participant. (ADD MORE)


